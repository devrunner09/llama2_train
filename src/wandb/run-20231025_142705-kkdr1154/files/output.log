

Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:45<00:00, 22.91s/it]
/workdir/env/lib/python3.10/site-packages/transformers/utils/hub.py:374: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
/workdir/env/lib/python3.10/site-packages/peft/utils/other.py:122: FutureWarning: prepare_model_for_int8_training is deprecated and will be removed in a future version. Use prepare_model_for_kbit_training instead.
  warnings.warn(
--> Model meta-llama/Llama-2-7b-hf
--> meta-llama/Llama-2-7b-hf has 262.41024 Million params
trainable params: 33,554,432 || all params: 6,771,970,048 || trainable%: 0.49548996469513035
=============================
Loading dataset at: /workdir/crawl_data/merge_QA_data.json
Current max words: 1024
=============================
This is raw prompt at index 0:
Below is an instruction that describes a task. Write a response that appropriately completes the request.
### Instruction:
Soáº¡n bÃ i thÆ¡ 10 cÃ¢u nÃ³i vá» váº» Ä‘áº¹p cá»§a mÃ¹a thu
### Response:
1. MÃ¹a thu tÆ°Æ¡i Ä‘áº¹p, rá»±c rá»¡ trong Ã¡nh náº¯ng vÃ ng.
2. CÃ¡nh Ä‘á»“ng lÃºa chÃ­n vÃ ng, cá» cÃ¢y Ãºa tÃ n theo giÃ³.
3. CÆ¡n giÃ³ láº¡nh thoáº£ng qua mang theo mÃ¹ aroma hoa lÃ¡.
4. Äiá»ƒm Ä‘áº­m cá»§a mÃ¹a thu lÃ  sáº¯c Ä‘á» rá»±c rá»¡ cá»§a nhá»¯ng chiáº¿c lÃ¡ khÃ´.
5. CÃ¡c loÃ i chim trá»i bay Ä‘áº¿n rá»£p cÃ nh cÃ¢y thÆ°á»Ÿng thá»©c váº» Ä‘áº¹p nÃ y.
6. SÃ¢n trÆ°á»ng, cÃ´ng viÃªn rá»±c rá»¡ mÃ u sáº¯c cá»§a cÃ¡c loÃ i hoa thÆ¡m lá»«ng.
7. HÆ°Æ¡ng tráº§m, hÆ°Æ¡ng nhÃ i cÃ¹ng vá»›i hÆ¡i láº¡nh cá»§a mÃ¹a thu táº¡o nÃªn má»™t khÃ­ trá»i thÆ¡m mÃ¡t, dá»… chá»‹u.
8. Báº§u trá»i xanh tháº³m, nhá»¯ng Ä‘Ã¡m mÃ¢y trÃ´i lá»¯ng thá»ƒ hiá»‡n sá»± dá»‹u dÃ ng cá»§a mÃ¹a thu.
9. Rung rinh giÃ³ lÃ¹a xoa nháº¹, Ä‘Æ°a cÃ¡nh hoa má»ng bay trÃ´i giá»¯a khÃ´ng trung rá»±c rá»¡.
10. MÃ¹a thu lÃ  mÃ¹a cá»§a sá»± thanh bÃ¬nh, tÄ©nh láº·ng, Ä‘áº¹p nhÆ° má»™t tÃ¡c pháº©m nghá»‡ thuáº­t hoÃ n háº£o cá»§a thiÃªn nhiÃªn.
Prompt tensor size: torch.Size([73])
Sample tensor size: torch.Size([574])
Sample (after padding) tensor size: torch.Size([1024])
=============Training Example============
{'input_ids': tensor([    1, 13866,   338,  ...,     0,     0,     0]), 'labels': tensor([-100, -100, -100,  ..., -100, -100, -100]), 'attention_mask': tensor([1., 1., 1.,  ..., 0., 0., 0.])}
=========================================
--> Training Set Length = 93146
=============================
Loading dataset at: /workdir/crawl_data/merge_QA_data.json
Current max words: 1024
=============================
/workdir/env/lib/python3.10/site-packages/torch/cuda/memory.py:303: FutureWarning: torch.cuda.reset_max_memory_allocated now calls torch.cuda.reset_peak_memory_stats, which resets /all/ peak memory stats.
  warnings.warn(
Training Epoch: 0:   0%|[34m                                                                  [39m| 0/23286 [00:00<?, ?it/s]/workdir/env/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:321: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
--> Validation Set Length = 200


















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































Training Epoch: 0/3, step 3859/23286 completed (loss: 0.6347221732139587): : 7447870it [12:00:32, 351.26it/s]Traceback (most recent call last):
  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/workdir/llama-recipes/src/llama_recipes/finetuning.py", line 277, in <module>
    fire.Fire(main)
  File "/workdir/env/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/workdir/env/lib/python3.10/site-packages/fire/core.py", line 475, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/workdir/env/lib/python3.10/site-packages/fire/core.py", line 691, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/workdir/llama-recipes/src/llama_recipes/finetuning.py", line 243, in main
    results = train(
  File "/workdir/llama-recipes/src/llama_recipes/utils/train_utils.py", line 93, in train
    loss.backward()
  File "/workdir/env/lib/python3.10/site-packages/torch/_tensor.py", line 487, in backward
    torch.autograd.backward(
  File "/workdir/env/lib/python3.10/site-packages/torch/autograd/__init__.py", line 200, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
Traceback (most recent call last):
  File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/workdir/llama-recipes/src/llama_recipes/finetuning.py", line 277, in <module>
    fire.Fire(main)
  File "/workdir/env/lib/python3.10/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/workdir/env/lib/python3.10/site-packages/fire/core.py", line 475, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
  File "/workdir/env/lib/python3.10/site-packages/fire/core.py", line 691, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/workdir/llama-recipes/src/llama_recipes/finetuning.py", line 243, in main
    results = train(
  File "/workdir/llama-recipes/src/llama_recipes/utils/train_utils.py", line 93, in train
    loss.backward()
  File "/workdir/env/lib/python3.10/site-packages/torch/_tensor.py", line 487, in backward
    torch.autograd.backward(
  File "/workdir/env/lib/python3.10/site-packages/torch/autograd/__init__.py", line 200, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt