

Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:26<00:00, 13.05s/it]
/workdir/env/lib/python3.10/site-packages/peft/utils/other.py:122: FutureWarning: prepare_model_for_int8_training is deprecated and will be removed in a future version. Use prepare_model_for_kbit_training instead.
  warnings.warn(
--> Model /workdir/ViLLM/finetuned_models
--> /workdir/ViLLM/finetuned_models has 262.41024 Million params
/workdir/env/lib/python3.10/site-packages/torch/cuda/memory.py:303: FutureWarning: torch.cuda.reset_max_memory_allocated now calls torch.cuda.reset_peak_memory_stats, which resets /all/ peak memory stats.
  warnings.warn(
Training Epoch: 0:   0%|[34m                                                                        [39m| 0/6532 [00:00<?, ?it/s]
trainable params: 4,194,304 || all params: 6,742,609,920 || trainable%: 0.06220594176090199
--> Training Set Length = 26129
Training Epoch: 0:   0%|[34m                                                                        [39m| 0/6532 [00:00<?, ?it/s]/workdir/env/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:321: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")














































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































Training Epoch: 0/3, step 6530/6532 completed (loss: 0.5136632323265076): : 21323715it [7:39:53, 2090.63it/s]
Training Epoch: 0/3, step 6531/6532 completed (loss: 0.779475212097168): : 21330246it [7:39:56, 2092.70it/s]
evaluating Epoch:   0%|[32m                                                            [39m| 0/200 [00:00<?, ?it/s]
Max CUDA memory allocated was 8 GB
Max CUDA memory reserved was 8 GB
Peak active CUDA memory was 8 GB
Cuda Malloc retires : 0































































Training Epoch: 0/3, step 6531/6532 completed (loss: 0.779475212097168): : 21330246it [7:42:05, 769.35it/s]
Training Epoch: 1:   0%|[34m                                                          [39m| 0/6532 [00:00<?, ?it/s]
 eval_ppl=tensor(nan, device='cuda:0') eval_epoch_loss=tensor(nan, device='cuda:0')
Epoch 1: train_perplexity=nan, train_epoch_loss=nan, epcoh time 27596.75922895409s








































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































Training Epoch: 1/3, step 6531/6532 completed (loss: 0.7019078135490417): : 21330246it [5:41:18, 2058.56it/s]
Saving model at epoch: 1
Max CUDA memory allocated was 8 GB
Max CUDA memory reserved was 8 GB
Peak active CUDA memory was 8 GB
Cuda Malloc retires : 0


Training Epoch: 1/3, step 6531/6532 completed (loss: 0.7019078135490417): : 21330246it [5:43:32, 1034.80it/s]
 eval_ppl=tensor(nan, device='cuda:0') eval_epoch_loss=tensor(nan, device='cuda:0')
Epoch 2: train_perplexity=nan, train_epoch_loss=nan, epcoh time 20479.270734047983s


























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































Training Epoch: 2/3, step 6531/6532 completed (loss: 0.6273828744888306): : 21330246it [10:32:49, 2058.99it/s]
evaluating Epoch:  34%|[32mâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž                                 [39m| 68/200 [00:46<01:26,  1.52it/s]
Saving model at epoch: 2
Max CUDA memory allocated was 8 GB
Max CUDA memory reserved was 8 GB
Peak active CUDA memory was 8 GB
Cuda Malloc retires : 0















































Training Epoch: 2/3, step 6531/6532 completed (loss: 0.6273828744888306): : 21330246it [10:34:59, 559.85it/s]
 eval_ppl=tensor(nan, device='cuda:0') eval_epoch_loss=tensor(nan, device='cuda:0')
Epoch 3: train_perplexity=nan, train_epoch_loss=nan, epcoh time 37959.51607029885s
Key: avg_train_prep, Value: nan
Key: avg_train_loss, Value: nan
Key: avg_eval_prep, Value: nan
Key: avg_eval_loss, Value: inf
Key: avg_epoch_time, Value: 28678.515344433643
Key: avg_checkpoint_time, Value: 0.0009134408707420031